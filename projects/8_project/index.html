<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Master's Thesis | Jesús Ferrándiz</title> <meta name="author" content="Jesús Ferrándiz"> <meta name="description" content="Implementation of modular position/force controllers based on ROS2 for lower member rehabilitation parallel robots"> <meta name="keywords" content="robotics, software, computer-vision, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700%7CRoboto+Slab:100,300,400,500,700%7CMaterial+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://jeferal.github.io/projects/8_project/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Jesús </span>Ferrándiz</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/"></a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="nav-item "> <a class="nav-link" href="/experiences/">Experiences</a> </li> <li class="nav-item "> <a class="nav-link" href="/life/">Life</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Master's Thesis</h1> <p class="post-description">Implementation of modular position/force controllers based on ROS2 for lower member rehabilitation parallel robots</p> </header> <article> <p>I carried my Master’s Thesis in a research laboratory that belonged to a research institute <a href="https://www.ai2.upv.es/en/home-english/" rel="external nofollow noopener" target="_blank">ai2.upv</a> were I was also taking an internship. The aim of the Thesis was to implement modular position/force controllers based on ROS2 for lower member rehabilitation parallel robots. After defending the Master’s Thesis, it was qualified with the highest grade 10/10 and with a <code class="language-plaintext highlighter-rouge">Special Mention</code>. I have been discussing in other posts some other implementation, but here you will find a summary of what my Thesis covered.</p> <h3 id="1-parallel-robots-for-rehabilitation-and-control-hardware">1. Parallel robots for rehabilitation and control hardware</h3> <p>As mention in the title, I worked with parallel robots for rehabilitation purposes of the lower member: ankle 3DOF, knee and ankle 4DOF. Parallel robots have the advantage that they are more accurate and have a better stiffness and strength/weight ratio than serial robots. In the following image you can see the robots I worked with:</p> <p align="center"> <img width="700" height="300" src="/assets/img/parallel_robots_rehabilitation.png"> </p> <div class="caption"> All the rehabilitation parallel robots I worked with. 3DOF, 4DOF and newer 4DOF. </div> <p>The control hardware was based on an industrial computer, which was running Ubuntu and that contained Data Acquisition Cards to be able to read the encoders of the robots and output the control action:</p> <p align="center"> <img width="400" height="300" src="/assets/img/daq_1.png"> </p> <div class="caption"> Advantech PCI-1784U used for reading the joint position sensors (high resolution encoders). </div> <h3 id="2-control-architecture---ros2">2. Control architecture - ROS2</h3> <p>There was a need to implement a control architecture that was based in a real time framework and also that was modular, so that it could be easily adapted to different robots and also so that researches and developers could easily implement newer and more complex controllers than position controllers. For this reason, ROS2 was chosen as the implementation framework. I did this work in 2020 and 2021 so the ROS2 version I worked with was Foxy. ROS2 is able to provide a more deterministic communication in the publisher - subscriber model that offers than ROS. This image shows the layers that ROS2 contains:</p> <p align="center"> <img width="400" height="300" src="/assets/img/ros2_layers.png"> </p> <div class="caption"> ROS2 layers, https://aws.amazon.com/es/blogs/robotics/ros2-foxy-fitzroy-robot-development/. </div> <h3 id="3-position-controller">3. Position Controller</h3> <p>This diagram shows the architecture of the implemented position controller. It is based on a standard PD algorithm and on a compensation of gravity.</p> <p align="center"> <img width="600" height="300" src="/assets/img/pdg_diagram.png"> </p> <div class="caption"> Diagram of the position controller PD + Gravity Compensation. </div> <p>Demonstration of the result:</p> <p align="center"> <iframe width="560" height="315" src="https://youtube.com/embed/d0ZvOFMC1OQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""> </iframe> </p> <div class="caption"> Position Controllers PD + Gravity Compensation. </div> <p>The following plots show important variables that are used to evaluate the control performance. To tune the controller, the accumulation of each position error and also the accumulation of the increment of the control action was used.</p> <figure> <picture> <img src="/assets/img/position_trajectory.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> PD + Gravity compensation - Desired trajectory and measured in joint space. </div> <figure> <picture> <img src="/assets/img/position_error.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> PD + Gravity compensation - Desired trajectory and measured in joint space position error. </div> <figure> <picture> <img src="/assets/img/control_action.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> PD + Gravity compensation - Control action. </div> <h3 id="4-more-complex-controllers-and-gui">4. More complex controllers and GUI</h3> <p>In this post I have only introduced my Master’s Thesis, in the following posts you can also read about particular controllers and implementations that my MS Thesis also covered:</p> <ul> <li><a href="/projects/5_project/">Force controllers</a></li> <li><a href="/projects/7_project/">Type II Singularity Releaser</a></li> <li><a href="/projects/6_project/">Position Controller based on Deep Reinforcement Learning</a></li> <li><a href="/projects/9_project/">Web-based graphical user interface</a></li> </ul> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Jesús Ferrándiz. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script defer src="/assets/js/copy_code.js" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>